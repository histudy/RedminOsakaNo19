---
title: 続・姫路IT系勉強会でのRedmineの運用方法
author: wate
date: 2019/03/09 第19回 Redmine大阪
---

## あんた誰？

* Twitter: [aWebprogrammer](https://twitter.com/aWebprogrammer)
* Github: [https://github.com/wate](https://github.com/wate)
* 元PHPer & 現Ansible使い
* 以下のコミュニティに参加してたりもします
  * [姫路IT系勉強会](https://histudy.jp/)
  * Ansible ユーザー会
  * さくらのクラウド ユーザーコミュニティ

------

## 前提条件

[Redmine Advent Calendar 2018](https://adventar.org/calendars/3352)で  
他の人に記事を書いてほしいと  
無茶振りをしてみたところ、  
以下の記事を書いてくれたことが  
今回の登壇の切っ掛けでした。

* [姫路IT系勉強会におけるRedmineの運用事例](https://histudy.jp/2018/12/02/blog/20181203_redmine_advent_calendar/)

------

## おさらい

姫路IT系勉強会で登録している  
トラッカーとステータスの内容を紹介します。

------

## トラッカーの一覧

トラッカーは、以下の５つがあります。

* 要望
* 不具合
* タスク
* 運用保守
* その他

------

### 要望

具体的なことが未定であったり  
提案などを含む場合に設定します。  
具体的に内容が決まったら  
各チケット種別に割り振ります。

------

### 不具合

既存の不具合などに設定します。

------

### タスク

新規や追加対応が必要な場合に設定します。

------

### 運用保守

定例対応やサーバ保守など、  
運用保守の範囲内で対応する場合に設定します。

------

### その他

いずれにも該当しない場合に設定します。

------

## ステータスの一覧

ステータスは以下の８つがあります。

* 未対応
* 対応中
* 対応済み
* 確認待ち
* フィードバック
* 経過観察中
* 完了
* 破棄

------

### 未対応

何も対応が行われていない場合に設定します。  
チケット起票時のデフォルトのステータスです。

------

### 対応中

対応を行っている場合に設定します。

------

### 対応済み

対応作業が完了しておりテスト中、  
または確認中の場合に設定します。

------

### 確認待ち

確認してほしい担当者や  
依頼者の確認待ちの場合に設定します。

------

### フィードバック

確認してほしい担当者による確認の結果、  
元の担当者に振り戻す場合に設定します。  
例えば、「対応漏れ」「不具合報告」  
「改善提案」などです。

------

### 経過観察中

本番環境で正常に動作しているか  
経過観察中の場合に設定します。

------

### 完了

すべての対応が完了した場合に設定します。

※終了扱いのチケットです。

------

### 破棄

対応が必要なかった場合に設定します。

※終了扱いのチケットです。

------

## 今回のお話は

アドカレの記事では紹介しきれなかった、  
勉強会でのRedmineの運用事例の  
「その後」を紹介したいと思います。

------

## 現状の問題点

### 問題点1

チケットの期日が過ぎているにも関わらず  
チケットが更新されません。

### 問題点2

定期的に行うタスクのチケットを  
登録するのがめんどうです。

------

## どうやって問題解決するか

プラグインを導入しようと思いましたが、  
以下のような弊害があります。

* サーバーの管理権限がない場合はどうするの？
* プラグインに頼るとRedmineのバージョンアップに追従しきれない
* 欲しい機能とちょっと違う、機能が足りない

------

## そこで・・

RedmineにはREST APIの機能がありますので、  
(簡単なプログラムが組めれば)  
全部クリアできますよね？

※プログラマー的な発想

------

## どうやって解決する？(問題点1)

チケットの期日が過ぎているにも関わらず  
チケットが更新されません。

Redmine自体にリマインダー機能はありますが、  
以下のような問題点が・・

* メールだとその人しか見えないよね
* 他のメールに埋もれそう

そこで・・・

------

## 解決方法(問題点1)

チケットの更新状況と同じように  
放置チケットもSlack通知させます。

他の人にも放置チケットの情報を共有すれば  
場合によっては引き取れるようになります。

REST API経由で期日超過のチケットを抽出して  
Slackに通知させるようにします！

* トラッカー：機能
* 優先度：高い
* ステータス：進行中

------

## どうやって解決する？(問題点2)

定期的に行うタスクのチケットを  
登録するのがめんどうです。

一応、以下のような情報もありますが・・

* [QA #273 定期的作業をチケットで作業管理したい](https://redmine.tokyo/issues/273)

分かりますが・・

* プラグインの機能が少し微妙/足りない
* シェルスクリプトは他の人がメンテできない

------

## 解決方法(問題点2)

雛形となるMarkdownファイルを用意しておいて、  
それを定期的に登録できれば解決できるのでは？

定期的にREST API経由で  
チケットを自動登録させます！

* トラッカー：要望
* 優先度：普通
* ステータス：進行中

------

## で、どうなった？

元PHPerの本領を発揮して鋭意作成中！

(まだ完成してない)

* [Redmine REST API](http://www.redmine.org/projects/redmine/wiki/Rest_api)
* [PHP Redmine API](https://github.com/kbsali/php-redmine-api)

------

## 残る問題はあと一つ

定期実行させるサーバーはどうするの？  
(サーバーのメンテができない、したくない)

そこで・・・

さくらのレンタルサーバーならcronが使えます！

[自動的に処理を実行させるcronを  
さくらスタンダードで動かしてみる](https://usortblog.com/sakuracron/)

※普通のレンタルサーバーの使い方じゃないけど気にしません！

------

## おまけ

勉強会のRedmineに導入しているプラグインは  
以下のようなものがあります。

* [Redmine Issue Templates](https://github.com/akiko-pusu/redmine_issue_templates)
* [Redmine Slack](https://github.com/cat-in-136/redmine-slack)
* [View Customize](https://github.com/onozaty/redmine-view-customize)
* [My Page Blocks](https://github.com/vividtone/redmine_vividtone_my_page_blocks)
* [Redmine Checklists (Light version)](https://www.redmineup.com/pages/ja/plugins/checklists)
* [PlantUML](https://github.com/dkd/plantuml)
